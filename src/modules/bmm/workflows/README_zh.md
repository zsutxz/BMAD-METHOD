---
last-redoc-date: 2025-10-12
---

# BMM工作流 - 完整的v6流程

BMM（BMAD方法模块）通过四个不同阶段编排软件开发，每个阶段都有专门的工作流，能够适应项目规模（0-4级）和上下文（全新项目vs现有项目）。本文档作为理解这些工作流如何相互连接以交付革命性v6方法论的主要指南。

## 核心v6创新

**规模自适应规划**：项目根据复杂性（0-4级）自动路由通过不同的工作流，确保适当的文档和流程开销。

**及时设计**：技术规格在实施期间一次一个史诗地创建，而不是全部预先创建，随着项目的发展融入学习成果。

**动态专业知识注入**：故事上下文工作流为每个故事提供有针对性的技术指导，用上下文专业知识替代静态文档。

**持续学习循环**：回顾将改进反馈回工作流，使每个史诗比上一个更顺畅。

## 四个阶段

```
┌──────────────────────────────────────────────────────────────┐
│                    阶段1：分析                         │
│                      (可选)                              │
├──────────────────────────────────────────────────────────────┤
│  brainstorm-game ──┐                                         │
│  brainstorm-project ├──→ research ──→ product-brief  ──┐     │
│  game-brief ────────┘                          game-brief ┘  │
└────────────────────────────────────────────────────────┼─────┘
                                                         ↓
┌──────────────────────────────────────────────────────────────┐
│                    阶段2：规划                         │
│              (规模自适应路由器 - 按类型)               │
├──────────────────────────────────────────────────────────────┤
│  软件: plan-project          游戏: gdd            │
│      ├──→ 级别0: 仅tech-spec      ├──→ GDD (所有级别) │
│      ├──→ 级别1: 仅tech-spec      └──→ 叙事设计 │
│      ├──→ 级别2: PRD + tech-spec                           │
│      └──→ 级别3-4: PRD + 史诗 ────────────────────────┐   │
└──────────────────────────────────────────────────────────┼───┘
                                                           ↓
┌──────────────────────────────────────────────────────────────┐
│                   阶段3：解决方案                       │
│              (软件级别3-4 / 复杂游戏)           │
├──────────────────────────────────────────────────────────────┤
│  3-solutioning ──→ architecture.md                  │
│       ↓                                                      │
│  tech-spec (每个史诗，实施期间JIT)             │
└────────────────────────────────────────────────────────────┬─┘
                                                             ↓
┌──────────────────────────────────────────────────────────────┐
│                  阶段4：实施                     │
│                    (迭代周期)                         │
├──────────────────────────────────────────────────────────────┤
│  ┌─→ create-story ──→ story-context ──→ dev-story ──┐        │
│  │                                                  ↓        │
│  │   retrospective ←── [史诗完成] ←────── review-story      │
│  │                                            ↓              │
│  └──────────── correct-course ←──[如果有问题]──┘              │
└──────────────────────────────────────────────────────────────┘
```

## 通用入口点：workflow-status

**在开始任何工作流之前，请检查您的状态！**

`workflow-status`工作流是所有BMM工作流的**通用入口点**：

```bash
bmad analyst workflow-status
# 或者
bmad pm workflow-status
```

**它的作用：**

- ✅ 检查现有工作流状态文件
- ✅ 显示当前阶段、进度和下一个操作
- ✅ 帮助新用户规划他们的工作流方法
- ✅ 引导现有项目首先进行文档化
- ✅ 根据上下文路由到适当的工作流

**没有状态文件？**它将：

1. 询问项目上下文（全新项目vs现有项目）
2. 提供分析选项（完整分析、跳转到规划或快速技术规格）
3. 引导您到正确的第一个工作流

**状态文件存在？**它将：

1. 显示当前阶段和进度
2. 显示阶段4实施状态（BACKLOG/TODO/IN PROGRESS/DONE）
3. 推荐确切的下一个操作
4. 提供更改工作流或显示菜单的选项

**所有代理（bmad-master、analyst、pm）在加载时都应检查workflow-status。**

---

## 阶段1：分析（可选）

用于项目发现和需求收集的可选工作流。输出输入到阶段2规划中。

### 工作流

| 工作流 | 目的 | 输出 | 何时使用 |
| ---------------------- | ------------------------------------------- | ------------------------- | ---------------------- |
| **workflow-status** | 通用入口点和状态检查器 | 状态显示 + 指导 | **始终从这里开始！** |
| **brainstorm-game** | 使用5种方法进行游戏概念构思 | 概念提案 | 新游戏项目 |
| **brainstorm-project** | 软件解决方案探索 | 架构提案 | 新软件项目 |
| **game-brief** | 结构化游戏设计基础 | 游戏简报文档 | 在创建GDD之前 |
| **product-brief** | 战略产品规划的高潮 | 产品简报 | 分析阶段结束时 |
| **research** | 多模式研究（市场/技术/深度） | 研究成果 | 当需要证据时 |

### 流程

```
workflow-status (检查) → 头脑风暴 → 研究 → 简报 → 规划 (阶段2)
```

## 阶段2：规划（必需）

确定项目规模并生成适当规划工件的中央编排器。

### 规模级别

| 级别 | 范围 | 输出 | 下一阶段 |
| ----- | ------------------------ | ------------------------------ | ------------------------------ |
| **0** | 单个原子更改 | tech-spec + 1个故事 | → 实施 |
| **1** | 1-10个故事，1个史诗 | tech-spec + 史诗 + 2-3个故事 | → 实施 |
| **2** | 5-15个故事，1-2个史诗 | PRD + 史诗 | → Tech-spec → 实施 |
| **3** | 12-40个故事，2-5个史诗 | PRD + 史诗 | → 解决方案 → 实施 |
| **4** | 40+个故事，5+个史诗 | PRD + 史诗 | → 解决方案 → 实施 |

**关键变更（v6a）：**

- **级别0**：现在除了tech-spec还生成一个用户故事
- **级别1**：现在作为规划的一部分生成2-3个故事（更偏好更长的故事而不是更多的故事）
- 级别0/1都跳过阶段3并自动填充阶段4故事待办事项列表

### 路由逻辑

**通用入口点**（workflow-status）：

```
workflow-status
    ├─→ 检查现有状态文件
    │   ├─→ 如果存在：显示状态 + 推荐下一个操作
    │   └─→ 如果不存在：引导工作流规划
    ├─→ 确定项目上下文（全新项目/现有项目）
    ├─→ 确定项目类型（游戏/网页/移动/后端等）
    ├─→ 评估复杂性 → 分配级别0-4
    ├─→ 映射完整工作流旅程
    └─→ 生成bmm-workflow-status.md + 指向第一个工作流
```

**直接路由**（无中间路由器）：

```
workflow-status确定路由：

    软件项目：
    ├─→ 级别0-1 → bmad architect tech-spec
    │   └─→ 验证状态文件 + 级别
    │   └─→ 生成tech-spec.md + 故事
    │   └─→ 直接到阶段4（实施）
    │
    ├─→ 级别2 → bmad pm prd
    │   └─→ 验证状态文件 + 级别
    │   └─→ 生成PRD.md + epics.md
    │   └─→ 然后：bmad architect tech-spec（轻量级解决方案）
    │   └─→ 然后：阶段4（实施）
    │
    └─→ 级别3-4 → bmad pm prd
        └─→ 验证状态文件 + 级别
        └─→ 生成PRD.md + epics.md
        └─→ 然后：阶段3（架构）
        └─→ 然后：阶段4（实施）

    游戏项目：
    └─→ 所有级别 → bmad pm gdd
        └─→ 验证状态文件 + 项目类型
        └─→ 生成GDD.md + epics.md
        └─→ 可选：叙事设计
        └─→ 然后：阶段3或4（基于复杂性）
```

### 关键输出

- **PRD.md**：产品需求文档（级别2-4）
- **Epics.md**：史诗分解及故事（级别2-4）
- **epic-stories.md**：史诗摘要及故事链接（级别1）
- **tech-spec.md**：技术规格（仅级别0-2）
- **story-{slug}.md**：单个用户故事（级别0）
- **story-{slug}-1.md, story-{slug}-2.md, story-{slug}-3.md**：用户故事（级别1）
- **GDD.md**：游戏设计文档（游戏项目）
- **bmm-workflow-status.md**：版本化工作流状态跟踪，包含故事待办事项列表

## 阶段3：解决方案（仅级别3-4）

复杂项目的架构和技术设计阶段。

### 工作流

| 工作流 | 负责人 | 目的 | 输出 | 时间 |
| ----------------- | --------- | ------------------------------ | ------------------------- | ----------------- |
| **3-solutioning** | 架构师 | 创建整体架构 | 包含ADR的architecture.md | 每个项目一次 |
| **tech-spec** | 架构师 | 创建史诗特定技术规格 | tech-spec-epic-N.md | 每个史诗一个，JIT |

### 及时技术规格

```
对于每个史诗按顺序：
    当准备好实施史诗时：
        架构师：仅为该史诗运行tech-spec工作流
        → 创建tech-spec-epic-N.md
        → 交接给实施
    完全实施史诗
    然后移动到下一个史诗
```

**关键**：技术规格在史诗准备好实施时一次创建一个，而不是全部预先创建。这可以防止过度设计并融入学习成果。

## 阶段4：实施（迭代）

将需求转化为工作软件的核心开发周期。

### 故事状态机

阶段4使用4状态生命周期来管理故事进展，在`bmm-workflow-status.md`中跟踪：

```
BACKLOG → TODO → IN PROGRESS → DONE
```

#### 状态定义

- **BACKLOG**：待起草故事的有序列表（在阶段转换时填充）
  - 包含所有故事的ID、标题和文件名
  - 顺序是连续的（史诗1的故事优先，然后是史诗2等）

- **TODO**：需要起草的单个故事（或已起草，等待批准）
  - SM在此处使用`create-story`工作流起草故事
  - 故事状态为"Draft"，直到用户批准
  - 用户运行`story-ready`工作流批准

- **IN PROGRESS**：批准开发的单个故事
  - 由`story-ready`工作流移动到这里
  - DEV使用`dev-story`工作流实施
  - 故事状态为"Ready"或"In Review"

- **DONE**：已完成的故事，带有日期和积分
  - 在DoD完成后由`story-done`工作流移动到这里
  - 已完成工作的不可变记录

**关键创新**：代理从不搜索"下一个故事" - 他们总是从状态文件中读取确切的故事。

### 实施循环

```
阶段转换（阶段2或3 → 阶段4）
  ↓
┌─────────────────────────────────────────────────┐
│  BACKLOG填充所有故事              │
│  TODO用第一个故事初始化               │
└───────────────────┬─────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────┐
│  SM: create-story (在TODO中起草故事)        │
│  读取：状态文件TODO部分                │
│  输出：带有Status="Draft"的故事文件         │
└───────────────────┬─────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────┐
│  用户审查故事                              │
│  ↓                                               │
│  SM: story-ready (批准故事)                │
│  操作：TODO → IN PROGRESS                     │
│           BACKLOG → TODO (下一个故事)            │
│           故事状态 = "Ready"                 │
└───────────────────┬─────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────┐
│  SM: story-context (可选但推荐)   │
│  生成专业知识注入XML               │
└───────────────────┬─────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────┐
│  DEV: dev-story (实施故事)               │
│  读取：状态文件IN PROGRESS部分         │
│  使用上下文注入实施               │
└───────────────────┬─────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────┐
│  用户审查实施 (DoD检查)         │
│  ↓                                               │
│  DEV: story-done (标记故事完成)          │
│  操作：IN PROGRESS → DONE                     │
│           TODO → IN PROGRESS (如果存在)         │
│           BACKLOG → TODO (如果存在)             │
│           故事状态 = "Done"                  │
└───────────────────┬─────────────────────────────┘
                    ↓
            ┌───────┴────────┐
            │  还有更多故事？  │
            └───────┬─────────┘
                ┌───┴───┐
                ↓       ↓
          [是：循环]  [否：史诗/项目完成]
                         ↓
                   [retrospective]
```

### 工作流职责

| 工作流 | 代理 | 目的 | 状态转换 | 无需搜索 |
| ------------------ | ------ | ------------------------------------- | --------------------- | ------------------------ |
| **create-story** | SM | 从TODO部分起草故事 | (故事留在TODO中) | 读取TODO部分 |
| **story-ready** | SM | 批准起草的故事进行开发 | TODO → IN PROGRESS | 读取TODO部分 |
| **story-context** | SM | 生成专业知识注入XML | (无状态更改) | 读取IN PROGRESS |
| **dev-story** | DEV | 实施故事 | (无状态更改) | 读取IN PROGRESS |
| **story-done** | DEV | 在DoD完成后标记故事完成 | IN PROGRESS → DONE | 读取IN PROGRESS |
| **review-story** | SR/DEV | 质量验证（可选） | (无状态更改) | 手动故事选择 |
| **correct-course** | SM | 处理问题/更改 | (自适应) | 手动故事选择 |
| **retrospective** | SM | 捕获史诗学习成果 | (无状态更改) | 手动或史诗触发 |

### 故事文件状态值

故事在其markdown文件中有一个`Status:`字段，反映它们在状态机中的位置：

```
Status: Draft       (由create-story创建的故事，等待用户审查)
  ↓
Status: Ready       (用户通过story-ready批准，准备实施)
  ↓
Status: In Review   (实施完成，等待最终批准)
  ↓
Status: Done        (用户通过story-done批准，DoD完成)
```

**状态文件位置 vs 故事文件状态：**

| 状态文件状态 | 故事文件状态 | 含义 |
| ----------------- | -------------------- | ------------------------------------- |
| BACKLOG | (文件不存在) | 故事尚未起草 |
| TODO | Draft | 故事已起草，等待用户批准 |
| IN PROGRESS | Ready 或 In Review | 故事已批准开发 |
| DONE | Done | 故事完成，DoD满足 |

## 全新项目 vs 现有项目考虑

### 全新项目

- 从阶段1（分析）或阶段2（规划）开始
- 在阶段3做出清晰的架构决策
- 在阶段4直接实施

### 现有项目

```
plan-project (阶段2)
    ├─→ 检查：现有代码库是否已文档化？
    │   ├─→ 是：继续规划
    │   └─→ 否：停止并显示消息：
    │       "现有项目需要文档化。
    │        请先运行codebase-analysis工作流。"
    │        └─→ [待定：brownfield-analysis工作流]
    │            ├─→ 分析现有代码
    │            ├─→ 文档化当前架构
    │            ├─→ 识别技术债务
    │            └─→ 创建基线文档
    └─→ 继续规模自适应规划
```

**现有项目关键**：没有对现有系统的充分文档化，规划阶段无法准确评估范围或创建有意义的需求。brownfield-analysis工作流（即将推出）将：

- 映射现有架构
- 文档化当前模式
- 识别集成点
- 评估技术债务
- 创建规划所需的基线

## 各阶段代理参与

| 阶段 | 主要代理 | 支持代理 |
| ------------------ | ------------------- | --------------------------- |
| **分析** | 分析师、研究员 | PM、PO |
| **规划** | PM | 分析师、UX专家 |
| **解决方案** | 架构师 | PM、技术负责人 |
| **实施** | SM、DEV | SR、PM（用于correct-course） |

## 关键文件和工件

### 跟踪文档

- **bmm-workflow-status.md**：版本化工作流状态跟踪，包含4部分故事待办事项列表
  - **BACKLOG**：待起草故事的有序列表
  - **TODO**：准备起草的单个故事（或已起草，等待批准）
  - **IN PROGRESS**：批准开发的单个故事
  - **DONE**：已完成的故事，带有日期和积分
  - 在阶段转换时自动填充
  - 故事进展的单一事实来源
  - 代理读取（从不搜索）以了解下一步要做什么

- **Epics.md**：史诗和故事的主列表（规划的事实来源，级别2-4）

### 阶段输出

- **阶段1**：简报和研究文档
- **阶段2**：
  - 级别0：tech-spec.md + story-{slug}.md
  - 级别1：tech-spec.md + epic-stories.md + story-{slug}-N.md文件
  - 级别2：PRD.md + epics.md（然后在阶段3中创建tech-spec.md）
  - 级别3-4：PRD.md + epics.md（然后在阶段3中创建architecture.md）
- **阶段3**：architecture.md，史诗特定技术规格
- **阶段4**：故事文件，上下文XML，实施的代码

## 最佳实践

### 1. 尊重规模

- 不要为级别0变更创建PRD
- 不要跳过级别3-4项目的架构
- 让工作流确定适当的工件

### 2. 拥抱及时性

- 一次一个史诗创建技术规格
- 按需生成故事，而不是批量生成
- 为每个故事构建上下文注入

### 3. 维护流程完整性

- 故事必须在Epics.md中枚举
- 每个阶段完成后下一个阶段才开始
- 使用新的上下文窗口进行审查

### 4. 首先文档化现有项目

- 没有理解现有代码不要规划
- 技术债务必须在规划中可见
- 集成点需要文档化

### 5. 持续学习

- 在每个史诗后运行回顾
- 基于学习成果更新工作流
- 跨团队分享模式

## 常见陷阱和解决方案

| 陷阱 | 解决方案 |
| --------------------------------- | ------------------------------------- |
| 预先创建所有技术规格 | 使用JIT方法 - 一次一个史诗 |
| 跳过story-context生成 | 在create-story后始终运行 |
| 批量创建故事 | 一次创建一个故事 |
| 忽略规模级别 | 让plan-project确定级别 |
| 在没有文档的情况下规划现有项目 | 首先运行brownfield-analysis |
| 不运行回顾 | 在每个史诗后安排 |

## 快速参考命令

```bash
# 通用入口点（从这里开始！）
bmad analyst workflow-status  # 检查状态并获得建议

# 阶段1：分析（可选）
bmad analyst brainstorm-project
bmad analyst research
bmad analyst product-brief

# 阶段2：规划
bmad pm prd             # 级别2-4软件项目
bmad architect tech-spec # 级别0-1软件项目
bmad pm gdd             # 游戏项目

# 阶段3：解决方案（L3-4）
bmad architect architecture
bmad architect tech-spec  # 每个史诗，JIT

# 阶段4：实施
bmad sm create-story      # 从TODO部分起草故事
bmad sm story-ready       # 批准故事进行开发（用户审查后）
bmad sm story-context     # 生成上下文XML（可选但推荐）
bmad dev dev-story        # 从IN PROGRESS部分实施故事
bmad dev story-done   # 标记故事完成（用户确认DoD后）
bmad dev review-story     # 质量验证（可选）
bmad sm correct-course    # 如果出现问题
bmad sm retrospective     # 史诗完成后
```

## 未来增强

### 即将推出

- **brownfield-analysis**：自动化代码库文档生成器
- **工作流编排**：自动阶段转换
- **进度仪表板**：实时工作流状态
- **团队同步**：多开发者故事协调

### 考虑中

- AI辅助回顾
- 自动故事 sizing
- 预测性史诗规划
- 跨项目学习转移

---

本文档作为BMM v6a工作流执行的权威指南。有关各个工作流的详细信息，请参阅工作流文件夹中各自的README文件。